# למה כדאי לך להתחיל להשתמש בבדיקת if שלילי בקוד שלך?

כולנו נתקלנו בסיטואציה הבאה: הקוד נראה תקין, הבדיקות עברו, אבל איכשהו באגים מצליחים \"לברוח\" ולהגיע לפרודקשן. אז מה אפשר לעשות כדי לכתוב קוד נכון יותר ולהפחית משמעותית את כמות הבאגים?

אחת הטכניקות שאני משתמש בה באופן קבוע כדי למנוע בדיוק את המקרים האלו היא כתיבת תנאי if שלילי, או Negative If Statement.

## מה זה בדיוק אומר?

במקום לבדוק תחילה את המקרה שבו הפעולה אמורה להתבצע, בודקים קודם כל את המקרים הלא תקינים, וכך \"פוסלים\" אותם מוקדם ככל האפשר. הגישה הזו נקראת גם \"Early Return\" ומאפשרת לקוד להיות קריא וברור הרבה יותר.

לדוגמה, במקום לכתוב ככה:

```javascript
if (user.isLoggedIn && user.hasPermission) {
  performSensitiveAction();
}
```

עדיף להשתמש בבדיקה שלילית:

```javascript
if (!user.isLoggedIn || !user.hasPermission) {
  // Handle the situation
  // Make sure to log the situation
  // throw | return | continue
}

performSensitiveAction();
```

## למה זה טוב יותר?

- **קריאות:** הקוד הופך להיות ברור וממוקד יותר כי המקרים החריגים נבדקים ונפסלים מראש.
- **בטיחות:** כך קל יותר לזהות באגים ולמנוע מהם לברוח, מכיוון שהתנאים הקריטיים נבדקים בצורה מפורשת וברורה.
- **תחזוקה:** הרבה יותר קל להוסיף תנאים חדשים או לטפל במקרים נוספים כשיש לך בדיקות ברורות בתחילת הפונקציה.

## חשיבות תיעוד השגיאה בלוגים

כאשר משתמשים בבדיקות if שליליות, נוצרת הזדמנות מצוינת לתיעוד והסבר של מדוע הפעולה לא הצליחה. זהו מקום טבעי להוסיף לוגים מפורטים שיעזרו לנו לדבג את המערכת בזמן אמת ובדיעבד. תיעוד נכון בלוגים הוא חלק בלתי נפרד מתהליך **ניהול השגיאות** (Error Handling) ומאפשר זיהוי מהיר של בעיות.

למשל, הנה דוגמה משופרת:

```javascript
if (!user.isLoggedIn) {
  logger.warn(`Access attempt without login: ${request.ip}`, {
    userId: user.id,
  });
  return res.status(401).send("Please login first");
}

if (!user.hasPermission) {
  logger.warn(`Permission denied for user: ${user.id}`, {
    action: "performSensitiveAction",
    requiredPermission: "admin",
  });
  return res.status(403).send("Insufficient permissions");
}

performSensitiveAction();
```

תיעוד נכון בלוגים מאפשר:

- **מעקב אחר בעיות אבטחה**: זיהוי ניסיונות גישה לא מורשים
- **הבנה של באגים**: כאשר יש באג, הלוגים יכולים להראות בדיוק מה קרה
- **שיפור חוויית המשתמש**: אפשר לזהות נקודות תקיעה שמשתמשים חווים
- **זמני תגובה מהירים יותר**: צוות התמיכה יכול לפתור בעיות מהר יותר עם הקשר מלא

## ניהול שגיאות כחלק מהתהליך

ניהול שגיאות נכון הוא לא רק כלי לדיבוג, אלא גם דרך לשפר את יציבות המערכת ואת חוויית המשתמש. שימוש בלוגים מפורטים, כמו בדוגמה למעלה, הוא רק חלק מהתמונה. חשוב גם:

- **להשתמש ב-try/catch**: במיוחד במקרים שבהם יש פעולות אסינכרוניות או גישה למשאבים חיצוניים.
- **להחזיר הודעות שגיאה ברורות**: כך שמשתמשים יוכלו להבין מה קרה ומה עליהם לעשות.
- **לנטר שגיאות באופן אוטומטי**: באמצעות כלים כמו Sentry או LogRocket, שמאפשרים מעקב אחר שגיאות בזמן אמת.

שילוב של בדיקות if שליליות עם ניהול שגיאות נכון יכול להפוך את הקוד שלך לא רק לקריא יותר, אלא גם לעמיד ואמין יותר.

## אבל רגע, יש גם טיעון נגד:

לפעמים, כתיבת if שלילי יכולה להוביל ליותר מדי early returns, ובמקרים כאלה הקוד עלול להפוך לקשה יותר למעקב ולהבנה, במיוחד בפונקציות ארוכות ומורכבות.

## אז מה עדיף?

כמו בהרבה דברים בקוד, חשוב למצוא את האיזון. עבור פונקציות קצרות וברורות, שימוש בבדיקת if שלילי לרוב יהיה יתרון. לעומת זאת, בפונקציות ארוכות ומורכבות, עדיף לפעמים דווקא להישאר עם if חיובי, תוך הקפדה על חלוקת הקוד לפונקציות קטנות יותר שיאפשרו לשמור על קריאות הקוד.

מאז שהתחלתי להשתמש בשיטה הזו בקביעות, כמות הבאגים שהצליחה להגיע לפרודקשן הצטמצמה משמעותית, והתהליך הפך לנוח ויעיל הרבה יותר.

ואתם? האם ניסיתם את הגישה הזאת? יש לכם טיפים נוספים לכתיבת קוד נכון וברור יותר?

ממליץ מאוד לצפות בסרטון הבא להעמקת ההבנה:

[צפו בסרטון המלא כאן](https://www.youtube.com/watch?v=CFRhGnuXG-4&ab_channel=CodeAesthetic)
